# Nixpacks configuration for Railway backend deployment
# Optimized to use system Chromium instead of bundled Puppeteer Chromium

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = ["npm run build --workspace=etp-express-backend"]

[start]
cmd = "npm run migration:run:prod --workspace=etp-express-backend && npm run start:prod --workspace=etp-express-backend"

[variables]
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD = "true"
PUPPETEER_EXECUTABLE_PATH = "/usr/bin/chromium"

# ============================================================================
# ETP EXPRESS - ENVIRONMENT VARIABLES TEMPLATE
# ============================================================================
#
# INSTRUCTIONS:
#   1. Copy this file to .env: cp .env.template .env
#   2. Fill in the required values (marked with *REQUIRED*)
#   3. Validate your .env: bash scripts/validate-env.sh
#   4. Start services: docker-compose up
#
# SECURITY:
#   - NEVER commit .env to git (.gitignore blocks it)
#   - Rotate secrets regularly (JWT_SECRET, API keys)
#   - Use strong passwords in production
#
# ============================================================================

# ----------------------------------------------------------------------------
# DATABASE (PostgreSQL)
# ----------------------------------------------------------------------------
# Database name for ETP Express
POSTGRES_DB=etp_express

# Database user
POSTGRES_USER=etp_user

# *REQUIRED* Database password
# Development: Use any password
# Production: Use strong password (32+ chars, random)
# Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=etp_password_dev_CHANGE_ME

# Database port (default: 5432)
POSTGRES_PORT=5432

# ----------------------------------------------------------------------------
# DATABASE PERFORMANCE TUNING (#108)
# ----------------------------------------------------------------------------
# Connection pooling configuration for optimal performance

# Maximum connections in pool
# Production: 50 (Railway max_connections=100, leave 50 for other services)
# Development: 10 (sufficient for local testing)
DB_POOL_MAX=50

# Minimum connections in pool (always maintained)
# Keeps connections warm for instant response
DB_POOL_MIN=10

# Idle timeout in milliseconds (30 seconds)
# Close idle connections to free resources
DB_IDLE_TIMEOUT=30000

# Connection acquire timeout in milliseconds (5 seconds)
# Fail fast if pool is exhausted to prevent cascading failures
DB_CONNECTION_TIMEOUT=5000

# Retry attempts on connection failure
DB_RETRY_ATTEMPTS=3

# Retry delay in milliseconds (1 second)
DB_RETRY_DELAY=1000

# Database synchronization (DANGER: Never true in production!)
# Auto-creates/updates tables based on entities
# Use migrations in production instead
DB_SYNCHRONIZE=false

# Database query logging (verbose in development, silent in production)
# Set to true to debug slow queries
DB_LOGGING=false

# Auto-run migrations on application startup
# Production: true (always apply latest schema)
# Development: true (convenience)
# Set to false if you prefer manual migration control
DB_MIGRATIONS_RUN=true

# ----------------------------------------------------------------------------
# SERVER CONFIGURATION
# ----------------------------------------------------------------------------
# Backend API port (default: 3001)
BACKEND_PORT=3001

# Frontend UI port (default: 5173 for Vite dev server)
FRONTEND_PORT=5173

# Node environment (development | production | test)
NODE_ENV=development

# ----------------------------------------------------------------------------
# AUTHENTICATION & SECURITY
# ----------------------------------------------------------------------------
# *REQUIRED* JWT Secret for token signing
# Development: Use any string
# Production: Use strong secret (32+ chars, random)
# Generate with: openssl rand -base64 32
JWT_SECRET=dev_jwt_secret_change_in_production_PLEASE

# JWT token expiration time (examples: 7d, 24h, 30m)
# Default: 7 days
JWT_EXPIRES_IN=7d

# ----------------------------------------------------------------------------
# OPENAI API (Content Generation)
# ----------------------------------------------------------------------------
# *REQUIRED* OpenAI API Key
# Get yours at: https://platform.openai.com/api-keys
# Cost: ~$0.01-0.03 per ETP generation (GPT-4)
OPENAI_API_KEY=sk-...your_openai_api_key_here...

# OpenAI model to use (default: gpt-4-turbo-preview)
# Options: gpt-4-turbo-preview, gpt-4, gpt-3.5-turbo
# Recommendation: gpt-4-turbo-preview for best quality
OPENAI_MODEL=gpt-4-turbo-preview

# ----------------------------------------------------------------------------
# PERPLEXITY API (Search & Research) - OPTIONAL
# ----------------------------------------------------------------------------
# Perplexity API Key (optional - used for enhanced search)
# Get yours at: https://www.perplexity.ai/settings/api
# Leave empty to disable Perplexity search feature
PERPLEXITY_API_KEY=

# ----------------------------------------------------------------------------
# SENTRY ERROR TRACKING - OPTIONAL
# ----------------------------------------------------------------------------
# Sentry DSN for error tracking (optional for development)
# Get yours at: https://sentry.io/
# Leave empty to disable Sentry
SENTRY_DSN=

# Sentry traces sample rate (0.0 to 1.0)
# Development: 1.0 (100% of requests)
# Production: 0.1 (10% of requests to reduce costs)
SENTRY_TRACES_SAMPLE_RATE=1.0

# Sentry environment name (auto-set from NODE_ENV if not provided)
# SENTRY_ENVIRONMENT=development

# ----------------------------------------------------------------------------
# FRONTEND SPECIFIC (Vite Environment Variables)
# ----------------------------------------------------------------------------
# Backend API URL for frontend
# Development (Docker): http://backend:3001/api
# Development (local): http://localhost:3001/api
# Production: https://your-backend-url.railway.app/api
VITE_API_URL=http://backend:3001/api

# Frontend Sentry DSN (optional)
# Same as backend SENTRY_DSN or separate project
VITE_SENTRY_DSN=

# Frontend Sentry environment
VITE_SENTRY_ENVIRONMENT=development

# ----------------------------------------------------------------------------
# RAILWAY DEPLOYMENT - AUTO-SET IN PRODUCTION
# ----------------------------------------------------------------------------
# Railway automatically sets these variables in production.
# DO NOT set manually - they are here for reference only.
#
# RAILWAY_GIT_COMMIT_SHA=<auto-set>    # Git commit SHA
# PORT=<auto-set>                       # Auto-assigned port
# DATABASE_URL=<auto-set>               # Auto-generated PostgreSQL URL
#
# ----------------------------------------------------------------------------

# ============================================================================
# VALIDATION CHECKLIST
# ============================================================================
#
# Before running the application, ensure:
#   [x] POSTGRES_PASSWORD is set (not default)
#   [x] JWT_SECRET is set (not default)
#   [x] OPENAI_API_KEY is set (valid API key)
#   [x] VITE_API_URL points to correct backend
#
# Validate with: bash scripts/validate-env.sh
#
# ============================================================================

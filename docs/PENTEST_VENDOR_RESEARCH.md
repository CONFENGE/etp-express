# üõ°Ô∏è Penetration Testing - Vendor Research & RFP Template

**Status:** Documenta√ß√£o de planejamento (execu√ß√£o pendente de aprova√ß√£o or√ßament√°ria)
**Parent Issue:** [#114 - Third-Party Penetration Testing & Vulnerability Disclosure](https://github.com/tjsasakifln/etp-express/issues/114)
**√öltima Atualiza√ß√£o:** 2025-11-26

---

## üìã √çndice

1. [Vendor Comparison Matrix](#1-vendor-comparison-matrix)
2. [RFP Template (Request for Proposal)](#2-rfp-template-request-for-proposal)
3. [Procurement Process](#3-procurement-process)

---

## 1. Vendor Comparison Matrix

### Vendors Pesquisados

#### 1. **Offensive Security** (USA)

**Website:** https://www.offensive-security.com/

- **Especializa√ß√£o:** OSCP certified pentesters (Offensive Security Certified Professional)
- **Pricing:** $3,000 - $7,000 USD
- **Turnaround:** 2-4 semanas
- **Retest:** Included (1 retest ap√≥s remediation)
- **Location:** USA (remote testing available)
- **Certification:** OSCP, OSWE, OSWP
- **Methodology:** OWASP Testing Guide, PTES (Penetration Testing Execution Standard)
- **Pros:**
  - Alta reputa√ß√£o internacional
  - Certifica√ß√£o OSCP reconhecida globalmente
  - Metodologia rigorosa e bem documentada
  - Experi√™ncia comprovada com web applications
- **Cons:**
  - USA-based (fuso hor√°rio GMT-5 to GMT-8)
  - Custo mais alto para mercado brasileiro
  - Comunica√ß√£o primariamente em ingl√™s

#### 2. **HackerOne** (Managed Pentests)

**Website:** https://www.hackerone.com/product/pentesting

- **Especializa√ß√£o:** Bug bounty platform + managed penetration testing
- **Pricing:** $5,000 - $15,000 USD
- **Turnaround:** 3-6 semanas
- **Retest:** Included (unlimited retests within scope)
- **Location:** USA (global hacker network)
- **Platform:** Integrated vulnerability management platform
- **Methodology:** OWASP, NIST, custom methodology
- **Pros:**
  - Plataforma integrada de vulnerability management
  - Continuous testing via bug bounty (optional)
  - M√∫ltiplos pentesters com especialidades diversas
  - Dashboard de tracking em tempo real
  - Op√ß√£o de transi√ß√£o para bug bounty program
- **Cons:**
  - Custo significativamente mais alto
  - Overhead de plataforma (learning curve)
  - Comunica√ß√£o via plataforma (pode ser menos direto)

#### 3. **BugCrowd** (Pentest + Bug Bounty)

**Website:** https://www.bugcrowd.com/products/penetration-testing/

- **Especializa√ß√£o:** Crowdsourced security testing
- **Pricing:** $4,000 - $10,000 USD
- **Turnaround:** 2-3 semanas
- **Retest:** Included (1 retest cycle)
- **Location:** USA (global crowd of researchers)
- **Platform:** Crowdsourced testing platform
- **Methodology:** OWASP, CWE Top 25, custom
- **Pros:**
  - M√∫ltiplos pentesters trabalhando simultaneamente
  - Cobertura ampla de attack vectors
  - Expertise diversificado (web, mobile, API, cloud)
  - Transi√ß√£o f√°cil para bug bounty cont√≠nuo
- **Cons:**
  - Qualidade vari√°vel (depende dos researchers alocados)
  - Coordena√ß√£o de crowd pode ser complexa
  - Menos controle sobre quem executa o teste

#### 4. **Tempest Security** (Brasil)

**Website:** https://www.tempest.com.br/

- **Especializa√ß√£o:** Penetration testing com foco em LGPD compliance
- **Pricing:** R$ 8,000 - R$ 20,000 (~$1,600 - $4,000 USD)
- **Turnaround:** 2-3 semanas
- **Retest:** Cota√ß√£o separada (n√£o inclu√≠do no pacote base)
- **Location:** Brasil (S√£o Paulo)
- **Certification:** CEH, OSCP, ISO 27001
- **Methodology:** OWASP, NIST, ABNT NBR ISO/IEC 27001
- **Pros:**
  - Brasil-based (mesmo fuso hor√°rio GMT-3)
  - Expertise espec√≠fico em LGPD e legisla√ß√£o brasileira
  - Comunica√ß√£o em portugu√™s
  - Conhecimento do contexto de setor p√∫blico brasileiro
  - Custo mais acess√≠vel (BRL pricing)
- **Cons:**
  - Menor reputa√ß√£o internacional comparado a Offensive Security
  - Retest n√£o inclu√≠do no pacote padr√£o
  - Menor presen√ßa em rankings globais de pentest

#### 5. **Conviso** (Brasil)

**Website:** https://www.convisoappsec.com/

- **Especializa√ß√£o:** Application Security (AppSec) + DevSecOps
- **Pricing:** R$ 10,000 - R$ 25,000 (~$2,000 - $5,000 USD)
- **Turnaround:** 3-4 semanas
- **Retest:** Included (1 retest cycle)
- **Location:** Brasil (S√£o Paulo, remoto)
- **Platform:** AppSec platform integrada
- **Methodology:** OWASP, SANS Top 25, LGPD assessment
- **Pros:**
  - Brasil-based (GMT-3, portugu√™s nativo)
  - Continuous testing e DevSecOps advisory (al√©m de pentest)
  - Treinamento de equipe inclu√≠do (Secure Coding Workshop)
  - LGPD compliance assessment integrado
  - Suporte p√≥s-pentest para remediation
- **Cons:**
  - Custo m√©dio-alto para mercado brasileiro
  - Foco em AppSec pode ser mais amplo que pentest tradicional
  - Turnaround ligeiramente mais longo (3-4 semanas)

---

### Tabela Comparativa

| Vendor                 | Price Range | Turnaround | Retest            | Location  | Specialization               |
| ---------------------- | ----------- | ---------- | ----------------- | --------- | ---------------------------- |
| **Offensive Security** | $3k - $7k   | 2-4 weeks  | ‚úÖ Included       | üá∫üá∏ USA    | OSCP certified pentesters    |
| **HackerOne**          | $5k - $15k  | 3-6 weeks  | ‚úÖ Unlimited      | üá∫üá∏ USA    | Bug bounty + managed pentest |
| **BugCrowd**           | $4k - $10k  | 2-3 weeks  | ‚úÖ Included       | üá∫üá∏ USA    | Crowdsourced testing         |
| **Tempest Security**   | $1.6k - $4k | 2-3 weeks  | ‚ùå Separate quote | üáßüá∑ Brasil | LGPD compliance              |
| **Conviso**            | $2k - $5k   | 3-4 weeks  | ‚úÖ Included       | üáßüá∑ Brasil | AppSec + DevSecOps           |

---

### Recomenda√ß√£o Preliminar

**Para ETP Express (setor p√∫blico brasileiro, or√ßamento limitado):**

**Top Choice: Conviso**

- ‚úÖ Brasil-based (portugu√™s, fuso hor√°rio, LGPD expertise)
- ‚úÖ Retest inclu√≠do
- ‚úÖ Treinamento de equipe inclu√≠do (maximize ROI)
- ‚úÖ Custo intermedi√°rio ($2k-5k)
- ‚ö†Ô∏è Trade-off: Turnaround ligeiramente mais longo (3-4 semanas)

**Alternative: Tempest Security**

- ‚úÖ Custo mais baixo ($1.6k-4k)
- ‚úÖ LGPD expertise
- ‚úÖ Brasil-based
- ‚ö†Ô∏è Trade-off: Retest n√£o inclu√≠do (custo adicional)

**If budget allows: Offensive Security**

- ‚úÖ M√°xima reputa√ß√£o internacional
- ‚úÖ OSCP certification (gold standard)
- ‚ö†Ô∏è Trade-off: Custo mais alto, comunica√ß√£o em ingl√™s

---

## 2. RFP Template (Request for Proposal)

### A. Project Overview

**Company:** ETP Express
**Industry:** Public Sector SaaS (Project Management for Brazilian Government)
**Stage:** Pre-production (pilot phase targeting Q1 2026)

**Technology Stack:**

- **Backend:** NestJS (TypeScript, Node.js)
- **Frontend:** React (TypeScript, Vite)
- **Database:** PostgreSQL 14+
- **Deployment:** Railway PaaS (containerized)
- **Authentication:** JWT (access + refresh tokens)
- **External APIs:** OpenAI GPT-4, Perplexity (LLM-based content generation)

**User Base:**

- **Target Users:** Public sector employees (servidores p√∫blicos brasileiros)
- **User Roles:** Admin, Regular User, Read-Only
- **Expected Load:** 100-500 concurrent users (pilot), 5,000+ (production scale)

**Compliance Requirements:**

- **LGPD** (Lei Geral de Prote√ß√£o de Dados - Brazilian GDPR)
- **Lei 14.133/2021** (Nova Lei de Licita√ß√µes - Public Procurement Law)
- **OWASP Top 10 (2023)**

---

### B. Scope of Pentest

#### In-Scope

**Application Components:**

- ‚úÖ Web application (React SPA frontend)
- ‚úÖ REST API (NestJS backend - all endpoints)
- ‚úÖ Authentication/Authorization (JWT implementation, role-based access control)
- ‚úÖ Database security (PostgreSQL access control, SQL injection testing)
- ‚úÖ Session management (token refresh, logout, concurrent sessions)
- ‚úÖ File upload/download functionality (ETP project documents)
- ‚úÖ User management (registration, password reset, profile updates)
- ‚úÖ LLM integration security (prompt injection, data leakage to OpenAI/Perplexity)

**Infrastructure:**

- ‚úÖ Railway deployment configuration
- ‚úÖ Environment variables and secrets management
- ‚úÖ HTTPS/TLS implementation
- ‚úÖ CORS configuration
- ‚úÖ Rate limiting and DDoS protection

**Compliance Testing:**

- ‚úÖ OWASP Top 10 (2023) coverage:
  - Broken Access Control
  - Cryptographic Failures
  - Injection (SQL, NoSQL, Command, LDAP)
  - Insecure Design
  - Security Misconfiguration
  - Vulnerable and Outdated Components
  - Identification and Authentication Failures
  - Software and Data Integrity Failures
  - Security Logging and Monitoring Failures
  - Server-Side Request Forgery (SSRF)
- ‚úÖ LGPD data protection controls:
  - Personal data encryption (at rest and in transit)
  - Data access logging and audit trails
  - User consent management
  - Data export and deletion (LGPD Articles 18-19)

#### Out-of-Scope

**Excluded from Testing:**

- ‚ùå Social engineering attacks (phishing campaigns, pretexting)
- ‚ùå Physical security (office security, dumpster diving)
- ‚ùå Denial of Service (DoS/DDoS) attacks (infrastructure stress testing)
- ‚ùå Third-party services owned by vendors:
  - OpenAI API infrastructure
  - Perplexity API infrastructure
  - Railway PaaS platform (managed by Railway)
  - PostgreSQL managed instance (Railway responsibility)
- ‚ùå Source code review (unless white-box testing is negotiated separately)
- ‚ùå Mobile applications (ETP Express is web-only currently)

---

### C. Testing Methodology

#### Required Testing Approaches

**1. Black-Box Testing (External Attacker Perspective)**

- No prior knowledge of application internals
- Simulates external attacker with no credentials
- Focus: Reconnaissance, unauthenticated endpoints, exposed data

**2. Grey-Box Testing (Authenticated User Perspective)**

- Test with valid user credentials (Regular User role)
- Simulates malicious insider or compromised account
- Focus: Privilege escalation, horizontal access control bypass, data exfiltration

**3. White-Box Testing (Optional - Preferred)**

- Access to source code repository (GitHub)
- Access to architecture documentation (ARCHITECTURE.md)
- Focus: Code-level vulnerabilities, business logic flaws, crypto weaknesses

#### Standards and Frameworks

**Required:**

- **OWASP Testing Guide v4** (primary methodology)
- **CVSS 3.1** scoring for all vulnerabilities
- **CWE** (Common Weakness Enumeration) mapping
- **LGPD Assessment** (specific to Brazilian data protection law)

**Optional:**

- PTES (Penetration Testing Execution Standard)
- NIST SP 800-115 (Technical Guide to Information Security Testing)

#### Deliverables Timeline

- **Retest:** Mandatory after remediation window (30-60 days post-initial report)

---

### D. Deliverables

#### 1. Executive Summary (Required)

**Target Audience:** Non-technical stakeholders (CTO, Product Manager, Legal)

**Content:**

- Overview of testing scope and methodology
- High-level summary of findings (count by severity: CRITICAL, HIGH, MEDIUM, LOW)
- Business impact assessment (risk to users, compliance, reputation)
- Summary of remediation recommendations
- Overall security posture rating (e.g., "Moderate Risk", "High Risk")

**Format:** PDF, 2-4 pages, non-technical language

#### 2. Technical Report (Required)

**Target Audience:** Engineering team (developers, DevOps, security engineers)

**Content for Each Vulnerability:**

- **Description:** What is the vulnerability? (technical explanation)
- **Location:** Affected endpoint, file, or component
- **Proof of Concept (PoC):** Step-by-step reproduction steps + screenshots/videos
- **Impact:** What can an attacker achieve? (data breach, privilege escalation, etc.)
- **CVSS Score:** CVSS 3.1 score (0-10) with vector string (e.g., `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N`)
- **CWE Mapping:** CWE ID (e.g., CWE-89 for SQL Injection)
- **Remediation:** Specific code changes, configuration updates, or mitigations
- **References:** OWASP guides, CVE databases, vendor advisories

**Risk Rating Categories:**

- **CRITICAL:** CVSS 9.0-10.0 (immediate fix required)
- **HIGH:** CVSS 7.0-8.9 (fix within 30 days)
- **MEDIUM:** CVSS 4.0-6.9 (fix within 90 days)
- **LOW:** CVSS 0.1-3.9 (document and accept risk or fix opportunistically)

**Format:** PDF + CSV export (for tracking in GitHub Issues)

#### 3. Retest Report (Required)

**Trigger:** After ETP Express implements fixes (30-60 day remediation window)

**Content:**

- Re-validation of all CRITICAL and HIGH vulnerabilities
- Confirmation of fix effectiveness (Verified Fixed, Partially Fixed, Not Fixed)
- New vulnerabilities introduced during remediation (regression testing)
- Updated security posture rating

**Format:** PDF, 1-3 pages

#### 4. Certificate of Completion (Optional)

**Content:**

- Certification that ETP Express underwent penetration testing
- Date of testing and retest
- Vendor signature and seal
- Valid for 12 months (annual re-testing recommended)

**Use Case:** Demonstrate due diligence to stakeholders, compliance auditors, or RFP responses

#### 5. Remediation Support (Optional - Negotiable)

**Service:**

- 4-8 hours of consulting post-report delivery
- Code review of fixes before retest
- Architecture advisory for security improvements

**Pricing:** Typically $100-200/hour or bundled in package

#### 6. Security Training Workshop (Optional - Preferred for Conviso)

**Service:**

- 4-hour Secure Coding Workshop for development team
- OWASP Top 10 deep dive
- Hands-on exercises (DVWA, WebGoat)

**Pricing:** $500-1,500 (varies by vendor)

---

### E. Timeline

**Proposed Schedule (from RFP issuance to completion):**

| Phase                     | Duration             | Milestone                                             |
| ------------------------- | -------------------- | ----------------------------------------------------- |
| **1. RFP Submission**     | TBD                  | RFP distributed to 3-5 vendors                        |
| **2. Proposal Review**    | +1 week              | Vendor proposals received and evaluated               |
| **3. Vendor Selection**   | +2 weeks             | Contract negotiation and SOW signature                |
| **4. Kickoff Meeting**    | +3 weeks             | Scoping call, credentials provisioning, NDA signature |
| **5. Testing Phase**      | 2-4 weeks            | Active penetration testing                            |
| **6. Report Delivery**    | Testing + 1 week     | Initial technical report + executive summary          |
| **7. Remediation Window** | 30-60 days           | ETP Express implements fixes                          |
| **8. Retest**             | Remediation + 1 week | Vendor re-validates fixes                             |
| **9. Final Report**       | Retest + 3 days      | Retest report + certificate (if applicable)           |

**Total Timeline:** ~12-16 weeks (3-4 months from RFP to final retest report)

**Critical Dates:**

- **Kickoff must occur before:** [TBD - insert date after budget approval]
- **Initial report delivery by:** [TBD - Kickoff + 5 weeks]
- **Retest completion by:** [TBD - Report + 8 weeks]

---

### F. Budget

**Budget Range:** $2,000 - $5,000 USD (R$ 10,000 - R$ 25,000 BRL at current exchange rate)

**Payment Terms:**

- **Option 1 (Standard):** 50% upfront, 50% on initial report delivery
- **Option 2 (Milestone-based):** 30% upfront, 40% on report delivery, 30% on retest completion

**Currency:** USD or BRL (vendor preference - BRL preferred for Brazilian vendors)

**Purchase Order (PO):** Required for Brazilian public sector compliance

**Inclusions in Budget:**

- Penetration testing (black-box + grey-box)
- Initial technical report + executive summary
- 1 retest cycle after remediation
- Basic remediation consulting (4 hours included)

**Exclusions (Optional Add-Ons):**

- White-box testing (source code review): +$500-1,000
- Extended remediation consulting: $100-200/hour
- Security training workshop: +$500-1,500
- Bug bounty program setup: Separate pricing

---

### G. Evaluation Criteria

Vendors will be evaluated using the following weighted scoring matrix:

| Criteria                | Weight | Description                                                               | Scoring (0-10)                |
| ----------------------- | ------ | ------------------------------------------------------------------------- | ----------------------------- |
| **Technical Expertise** | 30%    | Certifications (OSCP, CEH, etc.), past pentest portfolio, team experience | 0-10 points                   |
| **Price**               | 25%    | Total cost (lower is better within quality threshold)                     | 0-10 points (inverse scale)   |
| **Turnaround Time**     | 20%    | Time from kickoff to initial report delivery                              | 0-10 points (faster = higher) |
| **Retest Included**     | 15%    | Retest included in base price (Yes = 10, No = 0)                          | 0 or 10 points                |
| **LGPD Expertise**      | 10%    | Brazil-specific data protection law knowledge                             | 0-10 points                   |

**Scoring Formula:**

```
Total Score = (Tech Expertise √ó 0.30) + (Price √ó 0.25) + (Turnaround √ó 0.20) + (Retest √ó 0.15) + (LGPD √ó 0.10)
```

**Example Scoring:**

| Vendor             | Tech (30%) | Price (25%) | Turnaround (20%) | Retest (15%) | LGPD (10%) | **Total**   |
| ------------------ | ---------- | ----------- | ---------------- | ------------ | ---------- | ----------- |
| Offensive Security | 10 (3.0)   | 5 (1.25)    | 8 (1.6)          | 10 (1.5)     | 3 (0.3)    | **7.65**    |
| Conviso            | 8 (2.4)    | 8 (2.0)     | 7 (1.4)          | 10 (1.5)     | 10 (1.0)   | **8.30** ‚úÖ |
| Tempest            | 7 (2.1)    | 10 (2.5)    | 8 (1.6)          | 0 (0.0)      | 10 (1.0)   | **7.20**    |

_(Example: Conviso wins with score 8.30 based on balanced expertise, reasonable price, and LGPD specialization)_

**Minimum Qualifying Score:** 6.0 (vendors below this threshold are disqualified)

**Tie-Breaker:** If scores are within 0.5 points, prefer Brazil-based vendor (LGPD expertise + timezone alignment)

---

## 3. Procurement Process

### Step-by-Step Execution

#### **Step 1: Budget Approval**

**Responsible:** CTO / CFO / Product Manager
**Deliverable:** Approved budget of $2,000-5,000 USD
**Timeline:** 1-2 weeks (internal approval process)

**Actions:**

- [ ] Present business case for pentest (risk mitigation, LGPD compliance, stakeholder confidence)
- [ ] Justify budget range based on vendor research (this document)
- [ ] Obtain written approval (email or PO authorization)
- [ ] Allocate budget in financial system (if applicable)

**Blockers:**

- ‚ùå Budget not approved ‚Üí STOP (pentest cannot proceed without funding)
- ‚ö†Ô∏è Budget below $2,000 ‚Üí Consider Tempest Security (lower tier) or defer to next fiscal cycle

---

#### **Step 2: RFP Distribution**

**Responsible:** Security Lead / Engineering Manager
**Deliverable:** RFP sent to 3-5 vendors
**Timeline:** 1 day (email distribution)

**Actions:**

- [ ] Customize RFP template (Section 2 of this document) with specific dates
- [ ] Send RFP to vendors:
  - Offensive Security: [contact form on website]
  - HackerOne: [sales contact via platform]
  - BugCrowd: [pentest inquiry form]
  - Tempest Security: contato@tempest.com.br
  - Conviso: contato@convisoappsec.com
- [ ] Set proposal submission deadline (7-10 days from distribution)
- [ ] Include NDA template (if required by organization)

**Email Template:**

```
Subject: RFP - Penetration Testing Services for ETP Express

Dear [Vendor],

We are requesting proposals for penetration testing services for ETP Express,
a public sector SaaS application built with NestJS and React.

Please find attached our RFP document with detailed scope, timeline, and budget.

Proposal Deadline: [Date - 7 days from today]
Contact: security@confenge.com.br

We look forward to your proposal.

Best regards,
[Name]
[Title]
ETP Express
```

---

#### **Step 3: Proposal Review**

**Responsible:** Security Lead + Engineering Team
**Deliverable:** Scored vendor comparison matrix
**Timeline:** 1 week (after proposal deadline)

**Actions:**

- [ ] Receive vendor proposals (PDF or email)
- [ ] Score each vendor using Evaluation Criteria (Section 2.G)
- [ ] Create comparison spreadsheet:
  - Vendor name
  - Price
  - Turnaround
  - Retest included (Y/N)
  - CVSS scoring methodology
  - Team credentials (OSCP, CEH, etc.)
  - Total weighted score
- [ ] Schedule clarification calls with top 2-3 vendors (optional)
- [ ] Check references (ask vendors for 2-3 past clients)

**Red Flags (disqualify vendor):**

- üö© No CVSS scoring methodology
- üö© No certifications (OSCP, CEH, or equivalent)
- üö© Turnaround > 6 weeks
- üö© Price > $7,000 USD (exceeds budget)
- üö© No retest AND price in upper range

---

#### **Step 4: Vendor Selection**

**Responsible:** CTO / Security Lead
**Deliverable:** Signed contract with selected vendor
**Timeline:** 3-5 days (negotiation + signature)

**Actions:**

- [ ] Select top-scoring vendor from matrix
- [ ] Notify selected vendor (acceptance email)
- [ ] Notify rejected vendors (professional courtesy)
- [ ] Negotiate final terms:
  - Confirm scope (in-scope vs out-of-scope)
  - Confirm price and payment terms (50/50 or 30/40/30)
  - Confirm timeline (kickoff date, report delivery, retest)
  - Confirm deliverables (executive summary, technical report, retest)
- [ ] Review SOW (Statement of Work) and contract
- [ ] Sign NDA (if required)
- [ ] Sign contract (DocuSign or wet signature)

**Contract Must Include:**

- ‚úÖ Scope of work (explicit in-scope and out-of-scope items)
- ‚úÖ Deliverables (report formats, timelines)
- ‚úÖ Payment terms (milestones, currency, PO reference)
- ‚úÖ Confidentiality clause (NDA for source code access if white-box)
- ‚úÖ Limitation of liability (safe harbor for ethical hacking)
- ‚úÖ Termination clause (early exit if vendor underperforms)

---

#### **Step 5: Contract Negotiation**

**Responsible:** Legal (if available) / CTO
**Deliverable:** Executed contract (signed by both parties)
**Timeline:** 1 week (legal review + negotiations)

**Key Terms to Negotiate:**

- **Price:** Can we get discount for being public sector / non-profit? (10-15% discount possible)
- **Retest:** Ensure 1 retest cycle is included (non-negotiable)
- **White-box access:** Negotiate source code access if possible (improves findings quality)
- **Payment terms:** Push for 30/40/30 instead of 50/50 (less upfront risk)
- **Report format:** Confirm CSV export for vulnerability tracking in GitHub Issues

**SOW (Statement of Work) Template:**

```
STATEMENT OF WORK - Penetration Testing Services

Client: ETP Express
Vendor: [Vendor Name]
Effective Date: [Date]

1. SCOPE
   - Web application pentest (React SPA + NestJS API)
   - Black-box + grey-box testing
   - OWASP Top 10 (2023) + LGPD compliance assessment
   - See Section 2.B of RFP for full scope

2. DELIVERABLES
   - Executive Summary (PDF, 2-4 pages)
   - Technical Report (PDF + CSV, CVSS 3.1 scores)
   - Retest Report (after 30-60 day remediation)

3. TIMELINE
   - Kickoff: [Date]
   - Report Delivery: [Date - Kickoff + 3 weeks]
   - Retest: [Date - Report + 8 weeks]

4. PRICING
   - Total: $[Amount] USD
   - Payment: 50% upfront ($[Amount]), 50% on report delivery ($[Amount])

5. CREDENTIALS
   - Vendor to provide test account credentials
   - Client to provide staging environment URL
   - NDA signed (attached)

Signatures:
_________________          _________________
[Client Name, Title]       [Vendor Name, Title]
Date: ___________          Date: ___________
```

---

#### **Step 6: Kickoff**

**Responsible:** Security Lead + Vendor Project Manager
**Deliverable:** Kickoff meeting notes + credentials provisioned
**Timeline:** 1 week after contract signature

**Actions:**

- [ ] Schedule kickoff call (Zoom, Google Meet, Teams)
- [ ] Agenda:
  - Introductions (team members, roles)
  - Scope confirmation (review in-scope vs out-of-scope)
  - Methodology walkthrough (black-box, grey-box, OWASP)
  - Credentials provisioning (see below)
  - Communication protocol (Slack channel, email, status calls)
  - Emergency contact (if critical vulnerability found, who to notify?)
- [ ] Provision testing credentials:
  - **Regular User Account:** username + password (non-admin)
  - **Admin Account:** (optional for grey-box testing)
  - **Staging Environment URL:** https://staging.etp-express.com (NOT production)
- [ ] Whitelist vendor IP addresses (if firewall/rate limiting in place)
- [ ] Set up Slack channel: `#pentest-vendor-[vendorname]`
- [ ] Confirm testing window: "Testing can occur 24/7" or "9am-5pm BRT only"

**Kickoff Meeting Template:**

```
Agenda: ETP Express Pentest Kickoff

Date: [Date]
Attendees: [Client Team], [Vendor Team]

1. Introductions (10 min)
2. Scope Review (15 min)
   - In-scope: Web app, API, auth, database
   - Out-of-scope: Social engineering, DoS, third-party APIs
3. Methodology (10 min)
   - Black-box: Reconnaissance, unauthenticated testing
   - Grey-box: Authenticated user testing (Regular User role)
   - OWASP Top 10 + LGPD assessment
4. Credentials (5 min)
   - Regular User: test-user@etp.com / [password]
   - Admin: (to be provided if needed)
5. Communication (5 min)
   - Slack: #pentest-vendor-conviso
   - Email: security@confenge.com.br
   - Status calls: Weekly Fridays 2pm BRT
6. Timeline (5 min)
   - Testing: [Start Date] to [End Date] (2-3 weeks)
   - Report: [End Date + 1 week]
7. Q&A (10 min)

Action Items:
- [ ] Client: Provision credentials by [Date]
- [ ] Vendor: Send testing plan by [Date]
- [ ] Client: Whitelist vendor IPs by [Date]
```

---

#### **Step 7: Testing**

**Responsible:** Vendor (pentester team)
**Deliverable:** Completed penetration test
**Timeline:** 2-4 weeks (active testing phase)

**Client Actions (Monitoring):**

- [ ] Monitor application logs for unusual activity (vendor testing traffic)
- [ ] Attend weekly status calls (Friday 2pm BRT)
- [ ] Respond to vendor questions within 24 hours (unblock testing)
- [ ] Do NOT fix vulnerabilities during testing window (wait for report)

**Vendor Actions (Testing):**

- Reconnaissance (passive + active)
- Vulnerability scanning (automated tools)
- Manual testing (OWASP Testing Guide)
- Exploitation (proof-of-concept only, no data exfiltration)
- Privilege escalation testing
- LGPD compliance assessment
- Report writing

**Communication:**

- **Weekly Status Call:** Vendor provides update (% complete, preliminary findings count)
- **Critical Findings:** If CRITICAL vulnerability found, vendor notifies immediately (emergency protocol)

**Emergency Protocol:**

```
If CRITICAL vulnerability discovered (CVSS 9.0+):

1. Vendor pauses testing
2. Vendor notifies client via Slack + email within 1 hour
3. Client acknowledges within 4 hours
4. Client decides: "Fix now" or "Continue testing, fix after report"
5. Vendor resumes testing after confirmation
```

---

#### **Step 8: Report Review**

**Responsible:** Security Lead + Engineering Team
**Deliverable:** Triage matrix (GitHub Issues created for each vulnerability)
**Timeline:** 1 week after report delivery

**Actions:**

- [ ] Receive pentest report (PDF + CSV)
- [ ] Schedule report walkthrough call with vendor (1 hour)
- [ ] Review each vulnerability:
  - Understand PoC (can we reproduce?)
  - Validate CVSS score (agree or dispute)
  - Prioritize remediation (critical ‚Üí high ‚Üí medium ‚Üí low)
- [ ] Create GitHub Issues using **Vulnerability Triage Process** ([#299](https://github.com/tjsasakifln/etp-express/issues/299))
  - 1 issue per vulnerability
  - Label: `security`, `priority/P0` (for CRITICAL), `priority/P1` (for HIGH), etc.
  - Assign to engineering team
- [ ] Create remediation sprint plan:
  - CRITICAL: Fix within 7 days
  - HIGH: Fix within 30 days
  - MEDIUM: Fix within 90 days
  - LOW: Accept risk or defer to backlog

**Triage Meeting Agenda:**

```
Pentest Report Triage Meeting

Date: [Date]
Attendees: Security Lead, Backend Lead, Frontend Lead, CTO

1. Report Overview (vendor presents - 10 min)
   - Total vulnerabilities: X CRITICAL, Y HIGH, Z MEDIUM, W LOW
   - Top 3 critical findings
2. Vulnerability Review (40 min)
   - Walk through each CRITICAL and HIGH finding
   - Clarify PoC, impact, remediation
3. Remediation Planning (10 min)
   - Assign owners for each fix
   - Set deadlines (7/30/90 days)
   - Create GitHub Issues (#299 process)

Action Items:
- [ ] Engineering: Fix CRITICAL issues by [Date]
- [ ] Engineering: Submit fixes for retest by [Date + 30 days]
- [ ] Security Lead: Schedule retest with vendor
```

---

#### **Step 9: Remediation**

**Responsible:** Engineering Team (Backend, Frontend, DevOps)
**Deliverable:** Fixes implemented for all CRITICAL and HIGH vulnerabilities
**Timeline:** 30-60 days (remediation window)

**Actions:**

- [ ] Implement fixes for each vulnerability (follow vendor recommendations)
- [ ] Write tests to prevent regression (unit tests + integration tests)
- [ ] Update ARCHITECTURE.md if security patterns changed
- [ ] Code review all security fixes (mandatory peer review)
- [ ] Deploy fixes to staging environment
- [ ] Test fixes internally (QA validation)
- [ ] Prepare fixes for retest (do NOT deploy to production yet)

**GitHub Issue Workflow:**

```
Example Issue #305: [SEC-PENTEST] SQL Injection in /api/etps/:id

Labels: security, priority/P0, backend
Assigned: @backend-lead

## Vulnerability
SQL injection in ETP detail endpoint (CWE-89, CVSS 9.8 CRITICAL)

## PoC
GET /api/etps/1' OR '1'='1 --
Returns all ETPs (bypasses access control)

## Remediation
Use parameterized queries (TypeORM) instead of raw SQL:
- File: backend/src/etps/etps.service.ts:145
- Change: `db.raw()` ‚Üí `repository.findOne({ where: { id } })`

## Acceptance Criteria
- [ ] Fix implemented (parameterized query)
- [ ] Unit test added (injection attempt returns 400)
- [ ] Code reviewed
- [ ] Deployed to staging
- [ ] Retested by vendor (VERIFIED FIXED)
```

**Remediation Sprint Planning:**

- **Week 1-2:** Fix all CRITICAL (CVSS 9.0+)
- **Week 3-4:** Fix all HIGH (CVSS 7.0-8.9)
- **Week 5-8:** Fix MEDIUM (CVSS 4.0-6.9) if time allows

---

#### **Step 10: Retest**

**Responsible:** Vendor (retest team) + Client (validation)
**Deliverable:** Retest report confirming fixes
**Timeline:** 1 week (after remediation window)

**Actions:**

- [ ] Notify vendor that fixes are ready for retest
- [ ] Vendor re-tests all CRITICAL and HIGH vulnerabilities
- [ ] Vendor confirms status for each:
  - ‚úÖ **VERIFIED FIXED:** Vulnerability no longer exploitable
  - ‚ö†Ô∏è **PARTIALLY FIXED:** Mitigation in place but edge case remains
  - ‚ùå **NOT FIXED:** Vulnerability still exploitable
- [ ] Vendor performs regression testing (ensure fixes didn't introduce new vulns)
- [ ] Vendor delivers retest report (PDF, 1-3 pages)
- [ ] Client reviews retest report
- [ ] If all CRITICAL/HIGH are VERIFIED FIXED ‚Üí Accept report and close pentest
- [ ] If any CRITICAL/HIGH are NOT FIXED ‚Üí Schedule remediation round 2 (emergency fix)

**Retest Report Structure:**

```
ETP Express Penetration Test - Retest Report

Date: [Date]
Vendor: [Vendor Name]

Summary:
- Total Vulnerabilities Retested: 12 (5 CRITICAL, 7 HIGH)
- VERIFIED FIXED: 11 (92%)
- PARTIALLY FIXED: 1 (8%)
- NOT FIXED: 0 (0%)

Detailed Results:

1. [CRITICAL] SQL Injection in /api/etps/:id
   Status: ‚úÖ VERIFIED FIXED
   Validation: Parameterized query implemented, injection attempts blocked

2. [CRITICAL] JWT Secret Hardcoded in .env
   Status: ‚úÖ VERIFIED FIXED
   Validation: Secret rotated, Railway environment variable used

...

11. [HIGH] CORS Misconfiguration
    Status: ‚ö†Ô∏è PARTIALLY FIXED
    Validation: CORS restricted to production domain, but wildcard remains in staging
    Recommendation: Update staging CORS to specific domain

Conclusion:
ETP Express has successfully remediated 92% of vulnerabilities.
Remaining issue (#11) is low risk in staging environment.

Certificate of Completion: Issued (valid until [Date + 12 months])
```

---

#### **Step 11: Closure**

**Responsible:** Security Lead
**Deliverable:** Pentest closure report + lessons learned
**Timeline:** 3-5 days after retest completion

**Actions:**

- [ ] Receive certificate of completion from vendor (if applicable)
- [ ] Close all pentest-related GitHub Issues (tag: `pentest-2025`)
- [ ] Create **Security Advisory** (if vulnerabilities were severe):
  - Publish summary of vulnerabilities found and fixed
  - Reassure users that issues are resolved
  - Optionally: Publish Hall of Fame entry for vendor (if applicable)
- [ ] Archive pentest reports in secure location (`docs/pentests/2025/`)
- [ ] Update ARCHITECTURE.md with security improvements
- [ ] Schedule **Lessons Learned Retrospective:**
  - What went well? (vendor communication, remediation speed)
  - What went poorly? (blind spots, missed vulnerabilities internally)
  - Action items: (e.g., add pre-commit security linting, SAST tools)
- [ ] Plan next pentest (annual re-testing recommended - schedule for [Date + 12 months])

**Lessons Learned Template:**

```
Pentest 2025 - Lessons Learned Retrospective

Date: [Date]
Attendees: Security Lead, Engineering Team, CTO

What Went Well:
- ‚úÖ Vendor (Conviso) was responsive and professional
- ‚úÖ All CRITICAL issues fixed within 2 weeks
- ‚úÖ Retest passed with 92% verification rate

What Went Poorly:
- ‚ùå SQL injection vulnerability existed (should have caught in code review)
- ‚ùå CORS misconfiguration (lack of staging/production parity)

Root Causes:
- No SAST (Static Application Security Testing) in CI/CD pipeline
- Code review checklist doesn't include OWASP Top 10 items

Action Items:
- [ ] #320: Add Semgrep SAST to GitHub Actions (owner: DevOps, due: 2 weeks)
- [ ] #321: Create "Security Code Review Checklist" (owner: Security Lead, due: 1 week)
- [ ] #322: Implement pre-commit hook for secrets scanning (owner: DevOps, due: 2 weeks)
- [ ] Schedule next pentest for [Date + 12 months]
```

---

## üìÖ Next Steps (Post-Documentation)

**Immediate (No Budget Required):**

1. ‚úÖ This document is complete and ready for use when budget is approved
2. Share this document with CTO/CFO to support budget approval (reference in business case)

**When Budget Approved:**

1. Customize RFP timeline (Section 2.E) with actual dates
2. Execute Procurement Process (Section 3, Steps 1-11)
3. Track progress in GitHub Project or Kanban board

**Annual Recurrence:**

- Schedule pentest annually (every 12 months)
- Update vendor research (prices and capabilities change)
- Review RFP template for outdated terms

---

## üìö References

### Vendor Websites

- Offensive Security: https://www.offensive-security.com/
- HackerOne Pentesting: https://www.hackerone.com/product/pentesting
- BugCrowd Pentesting: https://www.bugcrowd.com/products/penetration-testing/
- Tempest Security: https://www.tempest.com.br/
- Conviso AppSec: https://www.convisoappsec.com/

### Standards and Frameworks

- OWASP Testing Guide v4: https://owasp.org/www-project-web-security-testing-guide/
- CVSS 3.1 Calculator: https://www.first.org/cvss/calculator/3.1
- CWE (Common Weakness Enumeration): https://cwe.mitre.org/
- PTES (Penetration Testing Execution Standard): http://www.pentest-standard.org/

### Compliance

- LGPD (Lei Geral de Prote√ß√£o de Dados): https://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/l13709.htm
- OWASP Top 10 (2023): https://owasp.org/www-project-top-ten/

### Internal References

- Parent Issue: [#114 - Third-Party Penetration Testing & Vulnerability Disclosure](https://github.com/tjsasakifln/etp-express/issues/114)
- Vulnerability Triage Process: [#299 - Documentar processo de triage de vulnerabilidades](https://github.com/tjsasakifln/etp-express/issues/299)
- ETP Express Architecture: [ARCHITECTURE.md](../ARCHITECTURE.md)

---

**Document Status:** ‚úÖ COMPLETO
**Pr√≥xima A√ß√£o:** Aguardar aprova√ß√£o or√ßament√°ria para iniciar Step 1 (Budget Approval)
**Owner:** Security Lead / CTO
**Review Date:** Anual (ou quando or√ßamento for aprovado)

# Story TD-010.2: TypeScript Strictness & Cleanup

## Metadata
| Campo | Valor |
|-------|-------|
| **Parent Story** | TD-010 (Backlog - Infrastructure & Long-term Improvements) |
| **Priority** | P4 |
| **Estimated Effort** | 2.5h |
| **Area** | Backend / Frontend / Config |
| **Debts Addressed** | SYS-10, SYS-11, SYS-12 |
| **Dependencies** | None |
| **Blocked By** | None |

---

## Description

Como equipe de desenvolvimento, quero habilitar flags de strictness do TypeScript (`strictBindCallApply`, `forceConsistentCasingInFileNames`) e limpar diretorios temporarios, para que o projeto tenha type safety completa e funcione corretamente em ambientes cross-platform (Linux, macOS, Windows).

---

## Technical Debts Addressed

### SYS-10: tmpfiles no frontend (BAIXA - 0.5h)

**Status atualizado:** Nao foram encontrados diretorios `tmpclaude-*` no frontend (verificacao de 2026-02-12). Podem ter sido limpos previamente.

**Resolucao:**
1. Verificar se diretorios `tmpclaude-*` ainda existem: `find frontend/ -name "tmpclaude-*" -type d`
2. Se existirem: remover e adicionar `tmpclaude-*` ao `.gitignore`
3. Se nao existirem: adicionar `tmpclaude-*` ao `.gitignore` preventivamente
4. Marcar como resolvido

### SYS-11: strictBindCallApply: false (BAIXA - 1h)

**Arquivo:** `backend/tsconfig.json` (linha 17)

**Problema:**
```json
{
  "compilerOptions": {
    "strictBindCallApply": false
  }
}
```
Desabilitar `strictBindCallApply` permite que `bind()`, `call()` e `apply()` sejam chamados com argumentos incorretos sem erro de compilacao. Reduz a type safety do TypeScript.

**Resolucao:**
1. Habilitar `strictBindCallApply: true`
2. Rodar `npm run typecheck` para identificar erros
3. Corrigir todos os erros de tipo encontrados
4. Validar que build funciona normalmente

### SYS-12: forceConsistentCasingInFileNames: false (BAIXA - 1h)

**Arquivo:** `backend/tsconfig.json` (linha 18)

**Problema:**
```json
{
  "compilerOptions": {
    "forceConsistentCasingInFileNames": false
  }
}
```
Sem essa flag, imports como `import X from './MyFile'` funcionam no Windows (case-insensitive) mas falham no Linux/macOS (case-sensitive). Risco de CI/deploy quebrar.

**Resolucao:**
1. Habilitar `forceConsistentCasingInFileNames: true`
2. Rodar `npm run typecheck` para identificar imports com casing inconsistente
3. Corrigir imports para corresponder ao casing exato dos arquivos
4. Validar que build funciona em CI (Linux)

---

## Acceptance Criteria

- [ ] `tmpclaude-*` adicionado ao `.gitignore` (preventivo)
- [ ] Diretorios temporarios `tmpclaude-*` removidos (se existentes)
- [ ] `strictBindCallApply` habilitado (`true`) em `backend/tsconfig.json`
- [ ] Zero erros de TypeScript com `strictBindCallApply: true`
- [ ] `forceConsistentCasingInFileNames` habilitado (`true`) em `backend/tsconfig.json`
- [ ] Zero erros de TypeScript com `forceConsistentCasingInFileNames: true`
- [ ] `npm run build` funciona sem erros
- [ ] `npm run typecheck` passa sem erros
- [ ] Suite de testes passa normalmente

---

## Test Plan

### SYS-10
- Verificar que `.gitignore` inclui `tmpclaude-*`
- Verificar que `git status` nao mostra diretorios temporarios

### SYS-11
- `npm run typecheck` com `strictBindCallApply: true` — zero erros
- Testes unitarios passam
- Build de producao funciona

### SYS-12
- `npm run typecheck` com `forceConsistentCasingInFileNames: true` — zero erros
- Verificar especificamente em CI (Linux) que imports nao quebram
- Build de producao funciona

---

## Files Affected

| Arquivo | Mudanca |
|---------|---------|
| `backend/tsconfig.json` | `strictBindCallApply: true`, `forceConsistentCasingInFileNames: true` |
| `.gitignore` | Adicionar `tmpclaude-*` |
| Arquivos com erros de `bind/call/apply` | Corrigir tipos |
| Arquivos com imports de casing inconsistente | Corrigir casing |

---

*Story criada em 2026-02-12 por @pm (Morgan) - AIOS v3.10.0*
